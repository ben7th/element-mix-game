{"version":3,"sources":["ui.coffee"],"names":[],"mappings":"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","file":"ui.js","sourceRoot":"/source/","sourcesContent":["# 元素分组最多 25 个，当显示出来的元素分组数量变化时，按照不同的布局来排列\r\n# 1个分组 布局1\r\n# 2个分组 布局2\r\n# 3-4个分组 布局3\r\n# 5-9个分组 布局4\r\n# 10-16个分组 布局5\r\n# 17-25个分组 布局6\r\n\r\nclass Layout\r\n  constructor: (@groups)->\r\n    count = @groups.length\r\n\r\n    switch\r\n      when count == 1 then @layout1()\r\n      when count == 2 then @layout2()\r\n      when count <= 4 then @layout3()\r\n      when count <= 9 then @layout4()\r\n      when count <= 16 then @layout5()\r\n      when count <= 25 then @layout6()\r\n\r\n  layout1: ->\r\n    console.log 'layout 1'\r\n    group = @groups[0]\r\n    group.layout_width = 80\r\n    group.layout_left = 10\r\n    group.layout_top = 10\r\n    group.layout_padding = 10\r\n\r\n  layout2: ->\r\n    console.log 'layout 2'\r\n    group0 = @groups[0]\r\n    group1 = @groups[1]\r\n\r\n    group0.layout_width = 40\r\n    group1.layout_width = 40\r\n\r\n    group0.layout_left = 30\r\n    group1.layout_left = 30\r\n\r\n    group0.layout_top = 10\r\n    group1.layout_top = 50\r\n\r\n    group0.layout_padding = 10\r\n    group1.layout_padding = 10\r\n\r\n  layout3: ->\r\n    console.log 'layout 3'\r\n    for group, idx in @groups\r\n      x = ~~(idx / 2)\r\n      y = idx % 2\r\n      \r\n      group.layout_width = 40\r\n      group.layout_top = 10 + 40 * y\r\n      group.layout_left = 10 + 40 * x\r\n      group.layout_padding = 10\r\n\r\n  layout4: ->\r\n    console.log 'layout 4'\r\n    for group, idx in @groups\r\n      x = ~~(idx / 3)\r\n      y = idx % 3\r\n      \r\n      group.layout_width = 26.666\r\n      group.layout_top = 10 + 26.666 * y\r\n      group.layout_left = 10 + 26.666 * x\r\n      group.layout_padding = 10\r\n\r\n\r\n  layout5: ->\r\n    console.log 'layout 5'\r\n    for group, idx in @groups\r\n      x = ~~(idx / 4)\r\n      y = idx % 4\r\n      \r\n      group.layout_width = 22.5\r\n      group.layout_top = 5 + 22.5 * y\r\n      group.layout_left = 5 + 22.5 * x\r\n      group.layout_padding = 10\r\n\r\n\r\n  layout6: ->\r\n    console.log 'layout 6'\r\n    for group, idx in @groups\r\n      x = ~~(idx / 5)\r\n      y = idx % 5\r\n      \r\n      group.layout_width = 18\r\n      group.layout_top = 5 + 18 * y\r\n      group.layout_left = 5 + 18 * x\r\n      group.layout_padding = 10\r\n\r\n\r\n# 元素\r\nclass Element\r\n  constructor: (@group, data)->\r\n    @name = data.name\r\n    @icon = data.icon\r\n    @desc = data.desc\r\n\r\n    # 初始化时是否显示\r\n    @done = data.done\r\n    @group.show = true if @done\r\n\r\n  # 构造 dom\r\n  render: ->\r\n    $element = jQuery '<div>'\r\n      .addClass 'element'\r\n      .attr 'data-name', @name\r\n      .attr 'data-group-name', @group.name\r\n\r\n    if @icon? and @icon.length > 0\r\n      jQuery '<div>'\r\n        .addClass 'ic'\r\n        .css 'background-image', \"url(data/icons/elements/#{@icon})\"\r\n        .appendTo $element\r\n      jQuery '<div>'\r\n        .addClass 'name'\r\n        .html @name\r\n        .appendTo $element\r\n    else\r\n      $element.addClass 'blank'\r\n      $element.html @name\r\n\r\n\r\n    return $element\r\n\r\n  toggle: (side)->\r\n    $area = @group.game.$playground.find(\".area.#{side}\")\r\n    $element = $area.find(\".element[data-name='#{@name}']\")\r\n\r\n    game = @group.game\r\n\r\n    if not $element.hasClass 'active'\r\n      # 如果已经有选中元素，合成\r\n      if game.$active_elm?\r\n        @mix game.$active_elm, $element\r\n\r\n      # 如果没有选中元素，选中当前元素\r\n      else\r\n        game.$active_elm = $element\r\n        $area.find('.element').removeClass 'active'\r\n        $element.addClass 'active'\r\n    else\r\n      game.$active_elm = null\r\n      $element.removeClass 'active'\r\n\r\n  # 尝试和指定的元素进行合成\r\n  mix: ($el0, $el1)->\r\n    name0 = $el0.data('name')\r\n    name1 = $el1.data('name')\r\n    console.log name0, 'mix with', name1\r\n\r\n    # 查找合成公式，判定是否合成成功\r\n    name = @try_mix(name0, name1)\r\n    if name?\r\n      @mix_success($el0, $el1, name)\r\n    else\r\n      @mix_failed($el0, $el1)\r\n\r\n  mix_success: ($el0, $el1, name)->\r\n    console.log 'mix success', name\r\n\r\n    # 隐藏左右两个元素区域\r\n    $el0.closest('.area').addClass 'hide'\r\n    $el1.closest('.area').addClass 'hide'\r\n\r\n    # 在相同的位置复制两个元素\r\n    $_el0 = @dup_position $el0\r\n    $_el1 = @dup_position $el1\r\n\r\n    @group.game.$merge.addClass 'show'\r\n    setTimeout =>\r\n      $_el0.addClass 'merged'\r\n      $_el1.addClass 'merged'\r\n      setTimeout =>\r\n        $_el0.fadeOut 100\r\n        $_el1.fadeOut 100, =>\r\n          $_el0.remove()\r\n          $_el1.remove()\r\n          # 显示合成出的新元素\r\n          # 合成出的新元素可能会有多个\r\n          element = @group.game.get_element name\r\n          $element = element.render()\r\n          $element\r\n            .addClass 'merged'\r\n            .appendTo @group.game.$merge\r\n\r\n          # 显示合成出的新元素所在的分组\r\n          # group = element.group\r\n\r\n          @group.game.$merge.addClass 'done'\r\n      , 500\r\n    , 200\r\n\r\n\r\n  dup_position: ($el)->\r\n    $mg = $el.closest('.playground').find('.merge')\r\n    mg_offset = $mg.offset()\r\n    el_offset = $el.offset()\r\n\r\n    $_el = $el.clone().removeClass('active')\r\n      .css\r\n        'left': el_offset.left - mg_offset.left\r\n        'top': el_offset.top - mg_offset.top\r\n\r\n    return $_el.appendTo $mg\r\n\r\n\r\n  mix_failed: ($el0, $el1)->\r\n    console.log 'mix failed'\r\n\r\n    @group.game.$active_elm = null\r\n\r\n    $el0.removeClass('active').addClass('shake')\r\n    $el1.removeClass('active').addClass('shake')\r\n\r\n    setTimeout ->\r\n      $el0.removeClass('shake')\r\n      $el1.removeClass('shake')\r\n    , 300\r\n\r\n  try_mix: (name0, name1)->\r\n    return '软盘'\r\n\r\n\r\n# 元素分组\r\nclass Group\r\n  constructor: (@game, data)->\r\n    @name = data.name\r\n    @icon = data.icon\r\n    @desc = data.desc\r\n    @elements = []\r\n\r\n    # 初始化时是否显示\r\n    @show = false\r\n\r\n    for element_data in data.elements\r\n      element = new Element @, element_data\r\n      @elements.push element\r\n\r\n  render: ->\r\n    $group = jQuery('<div>')\r\n      .addClass('group')\r\n      .attr 'data-name', @name\r\n\r\n    $icon = jQuery '<div>'\r\n      .addClass 'icon'\r\n      .appendTo $group\r\n\r\n    if @icon? and @icon.length > 0\r\n      $icon.css 'background-image', \"url(data/icons/#{@icon})\"\r\n    else\r\n      $icon.addClass 'blank'\r\n      $icon.html @name\r\n\r\n    # 应用 layout\r\n    $group.css\r\n      'width': \"#{@layout_width}%\"\r\n      'height': \"#{@layout_width}%\"\r\n      'line-height': \"#{@layout_width}%\"\r\n      'top': \"#{@layout_top}%\"\r\n      'left': \"#{@layout_left}%\"\r\n\r\n    $icon.css\r\n      'top': \"#{@layout_padding}%\"\r\n      'left': \"#{@layout_padding}%\"\r\n      'right': \"#{@layout_padding}%\"\r\n      'bottom': \"#{@layout_padding}%\"\r\n\r\n\r\n    $elements = jQuery '<div>'\r\n      .addClass 'elements'\r\n      .appendTo $group\r\n\r\n    for element in @elements\r\n      element.render().appendTo $elements\r\n\r\n    @$left_el = $group.clone()\r\n    @$right_el = $group.clone()\r\n\r\n    @els = {\r\n      'left': @$left_el\r\n      'right': @$right_el\r\n    }\r\n\r\n    @game.$left_area_groups.append @$left_el\r\n    @game.$right_area_groups.append @$right_el\r\n\r\n  toggle: (side)->\r\n    # 打开/关闭指定一侧的分组\r\n    $el = @els[side]\r\n    if not $el.hasClass('open')\r\n      $el.closest('.area').find('.groups .group').addClass 'hide'\r\n      $el.removeClass('hide').addClass('open')\r\n      \r\n      setTimeout ->\r\n        $el.find('.elements').fadeIn 100\r\n      , 300\r\n\r\n    else\r\n      $el.find('.elements').hide()\r\n      $el.find('.element').removeClass 'active'\r\n\r\n      @game.$active_elm = null if @game.$active_elm.data('name') == $el.find('.element').data('name')\r\n\r\n      $el.removeClass 'open'\r\n      setTimeout ->\r\n        $el.closest('.area').find('.groups .group').removeClass 'hide'\r\n      , 300\r\n\r\n  get_element: (name)->\r\n    for element in @elements\r\n      return element if \"#{element.name}\" == \"#{name}\"\r\n    return null\r\n\r\n\r\nclass Game\r\n  constructor: (@$playground)->\r\n    @$merge = @$playground.find('.merge')\r\n\r\n    @$left_area_groups = @$playground.find('.area.left .groups')\r\n    @$right_area_groups = @$playground.find('.area.right .groups')\r\n\r\n    @groups = []\r\n    @bind_events()\r\n    # @create_fsm()\r\n\r\n    @$active_elm = null\r\n\r\n  init: (json_url)->\r\n    # 载入分组数据\r\n    jQuery.getJSON json_url, (data)=>\r\n      for group_data in data.groups\r\n        group = new Group @, group_data\r\n        @groups.push group\r\n\r\n      @render_groups()\r\n\r\n  # 根据分组名获取分组\r\n  get_group: (name)->\r\n    for group in @groups\r\n      return group if group.name is name\r\n    return null\r\n\r\n  # 根据元素名获取元素\r\n  get_element: (name)->\r\n    for group in @groups\r\n      element = group.get_element name\r\n      return element if element?\r\n    return null\r\n\r\n\r\n  # 显示分组\r\n  render_groups: ->\r\n    layout = new Layout(@groups)\r\n\r\n    for group in @groups\r\n      if group.show\r\n        group.render()\r\n\r\n  # 事件绑定\r\n  bind_events: ->\r\n    that = @\r\n\r\n    # 点击分组\r\n    @$playground.delegate '.area .groups .group .icon', 'click', ->\r\n      $group = jQuery(@).closest('.group')\r\n      name = $group.data('name')\r\n\r\n      group = that.get_group(name)\r\n      side = $group.closest('.area').data('side')\r\n\r\n      # 找到并打开/关闭分组\r\n      group.toggle(side) if group?\r\n\r\n    # 点击元素\r\n    @$playground.delegate '.area .groups .group .element', 'click', ->\r\n      $element = jQuery(@)\r\n      name = $element.data('name')\r\n      group_name = $element.data('group-name')\r\n      # console.log name, group_name\r\n      group = that.get_group group_name\r\n      element = group.get_element name\r\n\r\n      side = $element.closest('.area').data('side')\r\n\r\n      # 选中/取消选中点击的元素\r\n      element.toggle(side) if element?\r\n\r\n    # 当合成结束时，点击页面，返回最初状态\r\n    jQuery(document.body).on 'click', =>\r\n      if @$merge.hasClass 'done'\r\n        @$merge.removeClass('show').removeClass('done')\r\n        @$merge.find('.element').remove()\r\n        @$playground.find('.area').removeClass 'hide'\r\n\r\n        @$active_elm.removeClass('active')\r\n        @$playground.find('.groups .group').removeClass('hide').removeClass('open')\r\n        @$playground.find('.elements').hide()\r\n\r\njQuery ->\r\n  $playground = jQuery('.playground')\r\n\r\n  # url = 'data/elements.json'\r\n  url = 'data/sample1.json'\r\n  # url = 'data/groups-fixture/1-groups.json'\r\n  # url = 'data/groups-fixture/2-groups.json'\r\n  # url = 'data/groups-fixture/4-groups.json'\r\n  # url = 'data/groups-fixture/9-groups.json'\r\n  # url = 'data/groups-fixture/16-groups.json'\r\n  # url = 'data/groups-fixture/25-groups.json'\r\n\r\n  # TODO 加入重名检测\r\n\r\n  new Game($playground).init url"]}