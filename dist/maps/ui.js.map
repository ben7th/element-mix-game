{"version":3,"sources":["ui.coffee"],"names":[],"mappings":"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","file":"ui.js","sourceRoot":"/source/","sourcesContent":["# 元素\r\nclass Element\r\n  constructor: (@group, data)->\r\n    @name = data.name\r\n    @icon = data.icon\r\n    @desc = data.desc\r\n\r\n    # 初始化时是否显示\r\n    @done = data.done\r\n    @group.show = true if @done\r\n\r\n  # 构造 dom\r\n  render: ->\r\n    $element = jQuery '<div>'\r\n      .addClass 'element'\r\n      .html @name\r\n      .attr 'data-name', @name\r\n      .attr 'data-group-name', @group.name\r\n\r\n    return $element\r\n\r\n  toggle: (side)->\r\n    $area = @group.game.$playground.find(\".area.#{side}\")\r\n    $element = $area.find(\".element[data-name='#{@name}']\")\r\n\r\n    if not $element.hasClass 'active'\r\n      $area.find('.element').removeClass 'active'\r\n      $element.addClass 'active'\r\n    else\r\n      $element.removeClass 'active'\r\n\r\n\r\n# 元素分组\r\nclass Group\r\n  constructor: (@game, data)->\r\n    @name = data.name\r\n    @icon = data.icon\r\n    @desc = data.desc\r\n    @elements = []\r\n\r\n    # 初始化时是否显示\r\n    @show = false\r\n\r\n    for element_data in data.elements\r\n      element = new Element @, element_data\r\n      @elements.push element\r\n\r\n  render: ->\r\n    $group = jQuery('<div>')\r\n      .addClass('group')\r\n      .attr 'data-name', @name\r\n\r\n    $icon = jQuery '<div>'\r\n      .addClass 'icon'\r\n      .html @name\r\n      .appendTo $group\r\n\r\n    $elements = jQuery '<div>'\r\n      .addClass 'elements'\r\n      .appendTo $group\r\n\r\n    for element in @elements\r\n      element.render().appendTo $elements\r\n\r\n    @$left_el = $group.clone()\r\n    @$right_el = $group.clone()\r\n\r\n    @els = {\r\n      'left': @$left_el\r\n      'right': @$right_el\r\n    }\r\n\r\n    @game.$left_area_groups.append @$left_el\r\n    @game.$right_area_groups.append @$right_el\r\n\r\n  toggle: (side)->\r\n    # 打开/关闭指定一侧的分组\r\n    $el = @els[side]\r\n    if not $el.hasClass('open')\r\n      $el.closest('.area').find('.groups .group').addClass 'hide'\r\n      $el\r\n        .removeClass 'hide'\r\n        .addClass 'open'\r\n    else\r\n      $el.find('.element').removeClass 'active'\r\n\r\n      $el.removeClass 'open'\r\n      setTimeout ->\r\n        $el.closest('.area').find('.groups .group').removeClass 'hide'\r\n      , 300\r\n\r\n  get_element: (name)->\r\n    for element in @elements\r\n      return element if \"#{element.name}\" == \"#{name}\"\r\n    return null\r\n\r\n\r\nclass Game\r\n  constructor: (@$playground)->\r\n    @$left_area_groups = @$playground.find('.area.left .groups')\r\n    @$right_area_groups = @$playground.find('.area.right .groups')\r\n\r\n    @groups = []\r\n    @bind_events()\r\n    # @create_fsm()\r\n\r\n  init: (json_url)->\r\n    # 载入分组数据\r\n    jQuery.getJSON json_url, (data)=>\r\n      for group_data in data.groups\r\n        group = new Group @, group_data\r\n        @groups.push group\r\n\r\n      @render_groups()\r\n\r\n  # 根据分组名获取分组\r\n  get_group: (name)->\r\n    for group in @groups\r\n      return group if group.name is name\r\n    return null\r\n\r\n  # 显示分组\r\n  render_groups: ->\r\n    for group in @groups\r\n      if group.show\r\n        group.render()\r\n\r\n  # 事件绑定\r\n  bind_events: ->\r\n    that = @\r\n\r\n    # 点击分组\r\n    @$playground.delegate '.area .groups .group .icon', 'click', ->\r\n      $group = jQuery(@).closest('.group')\r\n      name = $group.data('name')\r\n\r\n      group = that.get_group(name)\r\n      side = $group.closest('.area').data('side')\r\n\r\n      # 找到并打开/关闭分组\r\n      group.toggle(side) if group?\r\n\r\n    # 点击元素\r\n    @$playground.delegate '.area .groups .group .element', 'click', ->\r\n      $element = jQuery(@)\r\n      name = $element.data('name')\r\n      group_name = $element.data('group-name')\r\n      # console.log name, group_name\r\n      group = that.get_group group_name\r\n      element = group.get_element name\r\n\r\n      side = $element.closest('.area').data('side')\r\n\r\n      # 选中/取消选中点击的元素\r\n      element.toggle(side) if element?\r\n\r\n\r\njQuery ->\r\n  $playground = jQuery('.playground')\r\n\r\n  url = 'data/elements.json'\r\n  # url = 'data/sample1.json'\r\n\r\n  new Game($playground).init url\r\n"]}